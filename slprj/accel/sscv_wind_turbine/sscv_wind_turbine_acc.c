#include "sscv_wind_turbine_acc.h"
#include "sscv_wind_turbine_acc_types.h"
#include "mwmathutil.h"
#include "rtwtypes.h"
#include "sscv_wind_turbine_acc_private.h"
#include "simstruc_types.h"
#include <stdio.h>
#include "slexec_vm_simstruct_bridge.h"
#include "slexec_vm_zc_functions.h"
#include "slexec_vm_lookup_functions.h"
#include "slsv_diagnostic_codegen_c_api.h"
#include "simtarget/slSimTgtMdlrefSfcnBridge.h"
#include "simstruc.h"
#include "fixedpoint.h"
#define CodeFormat S-Function
#define AccDefine1 Accelerator_S-Function
#include "simtarget/slAccSfcnBridge.h"
real_T sscv_wind_turbine_acc_rt_TDelayInterpolate ( real_T tMinusDelay ,
real_T tStart , real_T * uBuf , int_T bufSz , int_T * lastIdx , int_T
oldestIdx , int_T newIdx , real_T initOutput , boolean_T discrete , boolean_T
minorStepAndTAtLastMajorOutput ) { int_T i ; real_T yout , t1 , t2 , u1 , u2
; real_T * tBuf = uBuf + bufSz ; if ( ( newIdx == 0 ) && ( oldestIdx == 0 )
&& ( tMinusDelay > tStart ) ) return initOutput ; if ( tMinusDelay <= tStart
) return initOutput ; if ( ( tMinusDelay <= tBuf [ oldestIdx ] ) ) { if ( discrete ) { return ( uBuf [ oldestIdx ] ) ; } else { int_T tempIdx = oldestIdx + 1 ; if ( oldestIdx == bufSz - 1 ) tempIdx = 0 ; t1 = tBuf [ oldestIdx ] ; t2 = tBuf [ tempIdx ] ; u1 = uBuf [ oldestIdx ] ; u2 = uBuf [ tempIdx ] ; if ( t2 == t1 ) { if ( tMinusDelay >= t2 ) { yout = u2 ; } else { yout = u1 ; } } else { real_T f1 = ( t2 - tMinusDelay ) / ( t2 - t1 ) ; real_T f2 = 1.0 - f1 ; yout = f1 * u1 + f2 * u2 ; } return yout ; } } if ( minorStepAndTAtLastMajorOutput ) { if ( newIdx != 0 ) { if ( * lastIdx == newIdx ) { ( * lastIdx ) -- ; } newIdx -- ; } else { if ( * lastIdx == newIdx ) { * lastIdx = bufSz - 1 ; } newIdx = bufSz - 1 ; } } i = * lastIdx ; if ( tBuf [ i ] < tMinusDelay ) { while ( tBuf [ i ] < tMinusDelay ) { if ( i == newIdx ) break ; i = ( i < ( bufSz - 1 ) ) ? ( i + 1 ) : 0 ; } } else { while ( tBuf [ i ] >= tMinusDelay ) { i = ( i > 0 ) ? i - 1 : ( bufSz - 1 ) ; } i = ( i < ( bufSz - 1 ) ) ? ( i + 1 ) : 0 ; } * lastIdx = i ; if ( discrete ) { double tempEps = ( DBL_EPSILON ) * 128.0 ; double localEps = tempEps * muDoubleScalarAbs ( tBuf [ i ] ) ; if ( tempEps > localEps ) { localEps = tempEps ; } localEps = localEps / 2.0 ; if ( tMinusDelay >= ( tBuf [ i ] - localEps ) ) { yout = uBuf [ i ] ; } else { if ( i == 0 ) { yout = uBuf [ bufSz - 1 ] ; } else { yout = uBuf [ i - 1 ] ; } } } else { if ( i == 0 ) { t1 = tBuf [ bufSz - 1 ] ; u1 = uBuf [ bufSz - 1 ] ; } else { t1 = tBuf [ i - 1 ] ; u1 = uBuf [ i - 1 ] ; } t2 = tBuf [ i ] ; u2 = uBuf [ i ] ; if ( t2 == t1 ) { if ( tMinusDelay >= t2 ) { yout = u2 ; } else { yout = u1 ; } } else { real_T f1 = ( t2 - tMinusDelay ) / ( t2 - t1 ) ; real_T f2 = 1.0 - f1 ; yout = f1 * u1 + f2 * u2 ; } } return ( yout ) ; } boolean_T rt_TDelayUpdateTailOrGrowBuf ( int32_T * bufSzPtr , int32_T * tailPtr , int32_T * headPtr , int32_T * lastPtr , real_T tMinusDelay , real_T * * uBufPtr , boolean_T isfixedbuf , boolean_T istransportdelay , int32_T * maxNewBufSzPtr ) { real_T * tBuf ; real_T * tempU ; real_T * tempX ; real_T * uBuf ; real_T * xBuf ; int32_T bufSz ; int32_T numBuffer ; int32_T tail ; int32_T testIdx ; boolean_T success ; success = true ; tail = * tailPtr ; bufSz = * bufSzPtr ; tBuf = & ( * uBufPtr ) [ bufSz ] ; xBuf = NULL ; if ( istransportdelay ) { numBuffer = 3 ; xBuf = & ( * uBufPtr ) [ bufSz << 1 ] ; } else { numBuffer = 2 ; } if ( tail < bufSz - 1 ) { testIdx = tail + 1 ; } else { testIdx = 0 ; } if ( ( tMinusDelay <= tBuf [ testIdx ] ) && ( ! isfixedbuf ) ) { tempX = NULL ; uBuf = * uBufPtr ; if ( bufSz + 1024 > * maxNewBufSzPtr ) { * maxNewBufSzPtr = bufSz + 1024 ; } tempU = ( real_T * ) malloc ( ( uint32_T ) ( ( ( bufSz + 1024 ) * numBuffer ) << 3 ) ) ; if ( tempU == NULL ) { success = false ; } else { if ( istransportdelay ) { tempX = & tempU [ ( bufSz + 1024 ) + ( bufSz + 1024 ) ] ; } for ( numBuffer = tail ; numBuffer < bufSz ; numBuffer ++ ) { tempU [ ( bufSz + 1024 ) + ( numBuffer - tail ) ] = tBuf [ numBuffer ] ; tempU [ numBuffer - tail ] = uBuf [ numBuffer ] ; if ( istransportdelay ) { tempX [ numBuffer - tail ] = xBuf [ numBuffer ] ; } } for ( numBuffer = 0 ; numBuffer <= tail ; numBuffer ++ ) { tempU [ ( bufSz + 1024 ) + ( ( numBuffer + bufSz ) - tail ) ] = tBuf [ numBuffer ] ; tempU [ ( numBuffer + bufSz ) - tail ] = uBuf [ numBuffer ] ; if ( istransportdelay ) { tempX [ ( numBuffer + bufSz ) - tail ] = xBuf [ numBuffer ] ; } } if ( * lastPtr > tail ) { * lastPtr -= tail ; } else { * lastPtr += bufSz - tail ; } * tailPtr = 0 ; * headPtr = bufSz ; free ( uBuf ) ; * bufSzPtr = bufSz + 1024 ; * uBufPtr = tempU ; } } else { * tailPtr = testIdx ; } return success ; } real_T look1_binlxpw ( real_T u0 , const real_T bp0 [ ] , const real_T table [ ] , uint32_T maxIndex ) { real_T frac ; real_T yL_0d0 ; uint32_T bpIdx ; uint32_T iLeft ; uint32_T iRght ; if ( u0 <= bp0 [ 0U ] ) { iLeft = 0U ; frac = ( u0 - bp0 [ 0U ] ) / ( bp0 [ 1U ] - bp0 [ 0U ] ) ; } else if ( u0 < bp0 [ maxIndex ] ) { bpIdx = maxIndex >> 1U ; iLeft = 0U ; iRght = maxIndex ; while ( iRght - iLeft > 1U ) { if ( u0 < bp0 [ bpIdx ] ) { iRght = bpIdx ; } else { iLeft = bpIdx ; } bpIdx = ( iRght + iLeft ) >> 1U ; } frac = ( u0 - bp0 [ iLeft ] ) / ( bp0 [ iLeft + 1U ] - bp0 [ iLeft ] ) ; } else { iLeft = maxIndex - 1U ; frac = ( u0 - bp0 [ maxIndex - 1U ] ) / ( bp0 [ maxIndex ] - bp0 [ maxIndex - 1U ] ) ; } yL_0d0 = table [ iLeft ] ; return ( table [ iLeft + 1U ] - yL_0d0 ) * frac + yL_0d0 ; } void rt_ssGetBlockPath ( void * S , int_T sysIdx , int_T blkIdx , char_T * * path ) { _ssGetBlockPath ( ( SimStruct * ) S , sysIdx , blkIdx , path ) ; } void rt_ssSet_slErrMsg ( void * S , void * diag ) { SimStruct * castedS = ( SimStruct * ) S ; if ( ! _ssIsErrorStatusAslErrMsg ( castedS ) ) { _ssSet_slErrMsg ( castedS , diag ) ; } else { _ssDiscardDiagnostic ( castedS , diag ) ; } } void rt_ssReportDiagnosticAsWarning ( void * S , void * diag ) { _ssReportDiagnosticAsWarning ( ( SimStruct * ) S , diag ) ; } void rt_ssReportDiagnosticAsInfo ( void * S , void * diag ) { _ssReportDiagnosticAsInfo ( ( SimStruct * ) S , diag ) ; } static void mdlOutputs ( SimStruct * S , int_T tid ) { B_sscv_wind_turbine_T * _rtB ; DW_sscv_wind_turbine_T * _rtDW ; P_sscv_wind_turbine_T * _rtP ; PrevZCX_sscv_wind_turbine_T * _rtZCE ; X_sscv_wind_turbine_T * _rtX ; real_T riseValLimit ; real_T rtb_B_6_246_1984 ; real_T rtb_B_6_247_1992 ; int32_T isHit ; boolean_T limitedCache ; boolean_T resetX ; ZCEventType zcEvent ; _rtDW = ( ( DW_sscv_wind_turbine_T * ) ssGetRootDWork ( S ) ) ; _rtZCE = ( ( PrevZCX_sscv_wind_turbine_T * ) _ssGetPrevZCSigState ( S ) ) ; _rtX = ( ( X_sscv_wind_turbine_T * ) ssGetContStates ( S ) ) ; _rtP = ( ( P_sscv_wind_turbine_T * ) ssGetModelRtp ( S ) ) ; _rtB = ( ( B_sscv_wind_turbine_T * ) _ssGetModelBlockIO ( S ) ) ; _rtB -> B_6_6_96 = 0.0 ; _rtB -> B_6_6_96 += _rtP -> P_36 * _rtX -> MeasurementFilter_CSTATE ; _rtB -> B_6_7_104 = 0.0 ; _rtB -> B_6_7_104 += _rtP -> P_38 * _rtX -> MeasurementFilter_CSTATE_f ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { ssCallAccelRunBlock ( S , 5 , 0 , SS_CALL_MDL_OUTPUTS ) ; } _rtB -> B_6_8_112 = 0.0 ; _rtB -> B_6_8_112 += _rtP -> P_40 * _rtX -> TransferFcn1_CSTATE ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtB -> B_6_236_1936 = ( ( _rtB -> B_5_216_1776 == _rtB -> B_6_186_1536 ) || ( _rtB -> B_5_216_1776 == _rtB -> B_6_187_1544 ) ) ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_236_1936 ) { if ( ! _rtDW -> TurbineState0an3_MODE ) { if ( ssGetTaskTime ( S , 1 ) != ssGetTStart ( S ) ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> Controller_CSTATE ) , 0 , 2 * sizeof ( boolean_T ) ) ; _rtX -> Controller_CSTATE = 0.0 ; _rtX -> Integrator_CSTATE_b = _rtP -> P_2 ; _rtDW -> TurbineState0an3_MODE = true ; } } else { if ( ssGetTaskTime ( S , 1 ) == ssGetTStart ( S ) ) { ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> Controller_CSTATE ) , 1 , 2 * sizeof ( boolean_T ) ) ; } if ( _rtDW -> TurbineState0an3_MODE ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> Controller_CSTATE ) , 1 , 2 * sizeof ( boolean_T ) ) ; _rtDW -> TurbineState0an3_MODE = false ; } } } } if ( _rtDW -> TurbineState0an3_MODE ) { _rtB -> B_0_232_1904 = 0.0 ; _rtB -> B_0_232_1904 += _rtP -> P_1 * _rtX -> Controller_CSTATE ; _rtB -> B_0_233_1912 = _rtX -> Integrator_CSTATE_b ; if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> Switch_Mode = ( _rtB -> B_0_233_1912 > _rtP -> P_3 ) ; } if ( _rtDW -> Switch_Mode ) { _rtB -> B_6_10_128 = _rtB -> B_0_232_1904 ; } else { _rtB -> B_6_10_128 = _rtB -> B_6_8_112 ; } if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> TurbineState0an3_SubsysRanBC ) ; } } isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtB -> B_6_237_1937 = ( _rtB -> B_5_216_1776 == _rtB -> B_6_188_1552 ) ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_237_1937 ) { if ( ! _rtDW -> TurbineState1_MODE ) { if ( ssGetTaskTime ( S , 1 ) != ssGetTStart ( S ) ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> TransferFcn_CSTATE_io ) , 0 , 1 * sizeof ( boolean_T ) ) ; _rtX -> TransferFcn_CSTATE_io = 0.0 ; _rtDW -> TurbineState1_MODE = true ; } } else { if ( ssGetTaskTime ( S , 1 ) == ssGetTStart ( S ) ) { ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> TransferFcn_CSTATE_io ) , 1 , 1 * sizeof ( boolean_T ) ) ; } if ( _rtDW -> TurbineState1_MODE ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> TransferFcn_CSTATE_io ) , 1 , 1 * sizeof ( boolean_T ) ) ; _rtDW -> TurbineState1_MODE = false ; } } } } if ( _rtDW -> TurbineState1_MODE ) { _rtB -> B_1_230_1888 = 0.0 ; _rtB -> B_1_230_1888 += _rtP -> P_7 * _rtX -> TransferFcn_CSTATE_io ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_1_230_1888 >= _rtP -> P_8 ) { _rtDW -> Saturation_MODE_h = 1 ; } else if ( _rtB -> B_1_230_1888 > _rtP -> P_9 ) { _rtDW -> Saturation_MODE_h = 0 ; } else { _rtDW -> Saturation_MODE_h = - 1 ; } } if ( _rtDW -> Saturation_MODE_h == 1 ) { _rtB -> B_6_10_128 = _rtP -> P_8 ; } else if ( _rtDW -> Saturation_MODE_h == - 1 ) { _rtB -> B_6_10_128 = _rtP -> P_9 ; } else { _rtB -> B_6_10_128 = _rtB -> B_1_230_1888 ; } if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> TurbineState1_SubsysRanBC ) ; } } _rtB -> B_6_9_120 = 0.0 ; _rtB -> B_6_9_120 += _rtP -> P_42 * _rtX -> MeasurementFilter_CSTATE_a ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtB -> B_6_238_1938 = ( _rtB -> B_5_216_1776 == _rtB -> B_6_189_1560 ) ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_238_1938 ) { if ( ! _rtDW -> TurbineState2_MODE ) { if ( ssGetTaskTime ( S , 1 ) != ssGetTStart ( S ) ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> Integrator_CSTATE_g ) , 0 , 2 * sizeof ( boolean_T ) ) ; _rtX -> Integrator_CSTATE_g = _rtP -> P_14 ; _rtX -> TransferFcn_CSTATE_b = 0.0 ; _rtDW -> TurbineState2_MODE = true ; } } else { if ( ssGetTaskTime ( S , 1 ) == ssGetTStart ( S ) ) { ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> Integrator_CSTATE_g ) , 1 , 2 * sizeof ( boolean_T ) ) ; } if ( _rtDW -> TurbineState2_MODE ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; ( void ) memset ( & ( ( ( XDis_sscv_wind_turbine_T * ) ssGetContStateDisabled ( S ) ) -> Integrator_CSTATE_g ) , 1 , 2 * sizeof ( boolean_T ) ) ; _rtDW -> TurbineState2_MODE = false ; } } } } if ( _rtDW -> TurbineState2_MODE ) { _rtB -> B_2_219_1800 = _rtB -> B_6_9_120 - _rtB -> B_2_228_1872 ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_2_219_1800 >= _rtP -> P_11 ) { _rtDW -> Saturation_MODE_cb = 1 ; } else if ( _rtB -> B_2_219_1800 > _rtP -> P_12 ) { _rtDW -> Saturation_MODE_cb = 0 ; } else { _rtDW -> Saturation_MODE_cb = - 1 ; } } if ( _rtDW -> Saturation_MODE_cb == 1 ) { _rtB -> B_2_220_1808 = _rtP -> P_11 ; } else if ( _rtDW -> Saturation_MODE_cb == - 1 ) { _rtB -> B_2_220_1808 = _rtP -> P_12 ; } else { _rtB -> B_2_220_1808 = _rtB -> B_2_219_1800 ; } _rtB -> B_2_221_1816 = _rtP -> P_13 * _rtB -> B_2_220_1808 ; _rtB -> B_2_222_1824 = _rtX -> Integrator_CSTATE_g ; _rtB -> B_2_223_1832 = look1_binlxpw ( _rtB -> B_6_6_96 , _rtP -> P_16 , _rtP -> P_15 , 8U ) ; _rtB -> B_2_224_1840 = _rtP -> P_17 * _rtB -> B_2_223_1832 ; _rtB -> B_2_225_1848 = ( ( _rtB -> B_2_229_1880 + _rtB -> B_2_221_1816 ) + _rtB -> B_2_222_1824 ) + _rtB -> B_2_224_1840 ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { { if ( _rtDW -> TAQSigLogging_InsertedFor_Add_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_Add_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_2_225_1848 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_DeratingPitch_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_DeratingPitch_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_2_223_1832 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_Gain_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_Gain_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_2_221_1816 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_Integrator_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_Integrator_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_2_222_1824 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_Sum_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_Sum_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_2_219_1800 + 0 ) ; } } } _rtB -> B_2_226_1856 = _rtP -> P_18 * _rtB -> B_2_220_1808 ; _rtB -> B_2_227_1864 = 0.0 ; _rtB -> B_2_227_1864 += _rtP -> P_20 * _rtX -> TransferFcn_CSTATE_b ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_2_227_1864 >= _rtP -> P_21 ) { _rtDW -> Saturation1_MODE_l = 1 ; } else if ( _rtB -> B_2_227_1864 > _rtP -> P_22 ) { _rtDW -> Saturation1_MODE_l = 0 ; } else { _rtDW -> Saturation1_MODE_l = - 1 ; } } if ( _rtDW -> Saturation1_MODE_l == 1 ) { _rtB -> B_6_10_128 = _rtP -> P_21 ; } else if ( _rtDW -> Saturation1_MODE_l == - 1 ) { _rtB -> B_6_10_128 = _rtP -> P_22 ; } else { _rtB -> B_6_10_128 = _rtB -> B_2_227_1864 ; } if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> TurbineState2_SubsysRanBC ) ; } } if ( _rtDW -> LastMajorTime == ( rtInf ) ) { _rtB -> B_6_11_136 = _rtB -> B_6_10_128 ; } else { rtb_B_6_247_1992 = ssGetTaskTime ( S , 0 ) - _rtDW -> LastMajorTime ; if ( _rtDW -> LastMajorTime == ssGetTaskTime ( S , 0 ) ) { if ( _rtDW -> PrevLimited ) { _rtB -> B_6_11_136 = _rtDW -> PrevY ; } else { _rtB -> B_6_11_136 = _rtB -> B_6_10_128 ; } } else { riseValLimit = rtb_B_6_247_1992 * _rtP -> P_44 ; rtb_B_6_246_1984 = _rtB -> B_6_10_128 - _rtDW -> PrevY ; if ( rtb_B_6_246_1984 > riseValLimit ) { _rtB -> B_6_11_136 = _rtDW -> PrevY + riseValLimit ; limitedCache = true ; } else { rtb_B_6_247_1992 *= _rtP -> P_45 ; if ( rtb_B_6_246_1984 < rtb_B_6_247_1992 ) { _rtB -> B_6_11_136 = _rtDW -> PrevY + rtb_B_6_247_1992 ; limitedCache = true ; } else { _rtB -> B_6_11_136 = _rtB -> B_6_10_128 ; limitedCache = false ; } } if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> PrevLimited = limitedCache ; } } } ssCallAccelRunBlock ( S , 6 , 15 , SS_CALL_MDL_OUTPUTS ) ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { { if ( _rtDW -> TAQSigLogging_InsertedFor_From10_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From10_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_5_214_1760 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_From11_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From11_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_5_215_1768 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_From12_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From12_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_5_216_1776 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_From13_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From13_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_6_11_136 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_From14_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From14_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_6_9_120 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_From15_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From15_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_6_6_96 + 0 ) ; } } { if ( _rtDW -> TAQSigLogging_InsertedFor_From8_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_From8_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_5_213_1752 + 0 ) ; } } if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> Compare_Mode = ( _rtB -> B_6_6_96 > _rtB -> B_6_190_1568 ) ; } _rtB -> B_6_239_1939 = _rtDW -> Compare_Mode ; if ( _rtB -> B_6_239_1939 ) { isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtB -> B_6_12_144 = _rtP -> P_25 * _rtB -> B_3_217_1784 ; _rtB -> B_6_18_192 = _rtB -> B_3_218_1792 ; } if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> DeratingControl_SubsysRanBC ) ; } } if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> Compare_Mode_a = ( _rtB -> B_6_6_96 <= _rtB -> B_6_191_1576 ) ; } _rtB -> B_6_240_1940 = _rtDW -> Compare_Mode_a ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_240_1940 ) { if ( ! _rtDW -> MPPTControl_MODE ) { if ( ssGetTaskTime ( S , 1 ) != ssGetTStart ( S ) ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } _rtDW -> MPPTControl_MODE = true ; } } else if ( _rtDW -> MPPTControl_MODE ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; _rtDW -> MPPTControl_MODE = false ; } } } if ( _rtDW -> MPPTControl_MODE ) { _rtB -> B_6_12_144 = _rtP -> P_31 * look1_binlxpw ( _rtB -> B_6_6_96 , _rtP -> P_30 , _rtP -> P_29 , 8U ) ; _rtB -> B_6_18_192 = look1_binlxpw ( _rtB -> B_6_6_96 , _rtP -> P_33 , _rtP -> P_32 , 8U ) ; if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> MPPTControl_SubsysRanBC ) ; } } if ( _rtB -> B_5_215_1768 > _rtP -> P_47 ) { _rtB -> B_6_13_152 = _rtB -> B_6_193_1592 ; } else { _rtB -> B_6_13_152 = _rtB -> B_6_12_144 ; } _rtB -> B_6_14_160 = _rtP -> P_48 * _rtB -> B_6_13_152 ; _rtB -> B_6_15_168 = 0.0 ; _rtB -> B_6_15_168 += _rtP -> P_50 * _rtX -> TransferFcn_CSTATE ; _rtB -> B_6_16_176 = _rtB -> B_6_14_160 * _rtB -> B_6_15_168 ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { if ( _rtB -> B_5_213_1752 > _rtP -> P_51 ) { _rtB -> B_6_17_184 = _rtB -> B_6_192_1584 ; } else { _rtB -> B_6_17_184 = _rtB -> B_6_194_1600 ; } } _rtB -> B_6_19_200 = 0.0 ; _rtB -> B_6_19_200 += _rtP -> P_54 * _rtX -> TransferFcn_CSTATE_l ; _rtB -> B_6_20_208 = _rtB -> B_6_19_200 * _rtB -> B_6_18_192 ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { if ( _rtB -> B_5_213_1752 > _rtP -> P_55 ) { _rtB -> B_6_21_216 = _rtB -> B_6_196_1616 ; } else { _rtB -> B_6_21_216 = _rtB -> B_6_195_1608 ; } _rtDW -> Step_MODE = ( ssGetTaskTime ( S , 1 ) >= _rtP -> P_56 ) ; if ( _rtDW -> Step_MODE == 1 ) { _rtB -> B_6_22_224 = _rtP -> P_58 ; } else { _rtB -> B_6_22_224 = _rtP -> P_57 ; } } _rtB -> B_6_23_232 = ssGetT ( S ) - _rtB -> B_6_197_1624 ; _rtB -> B_6_24_240 = _rtB -> B_6_22_224 * _rtB -> B_6_23_232 ; _rtB -> B_6_25_248 = _rtB -> B_6_24_240 + _rtB -> B_6_198_1632 ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_25_248 >= _rtP -> P_59 ) { _rtDW -> Saturation_MODE = 1 ; } else if ( _rtB -> B_6_25_248 > _rtP -> P_60 ) { _rtDW -> Saturation_MODE = 0 ; } else { _rtDW -> Saturation_MODE = - 1 ; } } if ( _rtDW -> Saturation_MODE == 1 ) { _rtB -> B_6_26_256 = _rtP -> P_59 ; } else if ( _rtDW -> Saturation_MODE == - 1 ) { _rtB -> B_6_26_256 = _rtP -> P_60 ; } else { _rtB -> B_6_26_256 = _rtB -> B_6_25_248 ; } isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtDW -> Step_MODE_f = ( ssGetTaskTime ( S , 1 ) >= _rtP -> P_61 ) ; if ( _rtDW -> Step_MODE_f == 1 ) { _rtB -> B_6_27_264 = _rtP -> P_63 ; } else { _rtB -> B_6_27_264 = _rtP -> P_62 ; } } _rtB -> B_6_28_272 = ssGetT ( S ) - _rtB -> B_6_199_1640 ; _rtB -> B_6_29_280 = _rtB -> B_6_27_264 * _rtB -> B_6_28_272 ; _rtB -> B_6_30_288 = _rtB -> B_6_29_280 + _rtB -> B_6_200_1648 ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_30_288 >= _rtP -> P_64 ) { _rtDW -> Saturation1_MODE = 1 ; } else if ( _rtB -> B_6_30_288 > _rtP -> P_65 ) { _rtDW -> Saturation1_MODE = 0 ; } else { _rtDW -> Saturation1_MODE = - 1 ; } } if ( _rtDW -> Saturation1_MODE == 1 ) { _rtB -> B_6_31_296 = _rtP -> P_64 ; } else if ( _rtDW -> Saturation1_MODE == - 1 ) { _rtB -> B_6_31_296 = _rtP -> P_65 ; } else { _rtB -> B_6_31_296 = _rtB -> B_6_30_288 ; } isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtDW -> Step_MODE_l = ( ssGetTaskTime ( S , 1 ) >= _rtP -> P_66 ) ; if ( _rtDW -> Step_MODE_l == 1 ) { _rtB -> B_6_32_304 = _rtP -> P_68 ; } else { _rtB -> B_6_32_304 = _rtP -> P_67 ; } } _rtB -> B_6_33_312 = ssGetT ( S ) - _rtB -> B_6_201_1656 ; _rtB -> B_6_34_320 = _rtB -> B_6_32_304 * _rtB -> B_6_33_312 ; _rtB -> B_6_35_328 = _rtB -> B_6_34_320 + _rtB -> B_6_202_1664 ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_35_328 >= _rtP -> P_69 ) { _rtDW -> Saturation2_MODE = 1 ; } else if ( _rtB -> B_6_35_328 > _rtP -> P_70 ) { _rtDW -> Saturation2_MODE = 0 ; } else { _rtDW -> Saturation2_MODE = - 1 ; } } if ( _rtDW -> Saturation2_MODE == 1 ) { _rtB -> B_6_36_336 = _rtP -> P_69 ; } else if ( _rtDW -> Saturation2_MODE == - 1 ) { _rtB -> B_6_36_336 = _rtP -> P_70 ; } else { _rtB -> B_6_36_336 = _rtB -> B_6_35_328 ; } _rtB -> B_6_37_344 = ( _rtB -> B_6_26_256 + _rtB -> B_6_31_296 ) + _rtB -> B_6_36_336 ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtB -> B_6_38_352 = ! ( _rtB -> B_5_215_1768 != 0.0 ) ; } _rtB -> B_6_39_360 [ 0 ] = _rtB -> B_6_38_352 ; _rtB -> B_6_39_360 [ 1 ] = 0.0 ; _rtB -> B_6_39_360 [ 2 ] = 0.0 ; if ( ssIsMajorTimeStep ( S ) != 0 ) { _rtDW -> INPUT_1_1_1_Discrete_1347933324 [ 0 ] = ! ( _rtB -> B_6_39_360 [ 0 ] == _rtDW -> INPUT_1_1_1_Discrete_1347933324 [ 1 ] ) ; _rtDW -> INPUT_1_1_1_Discrete_1347933324 [ 1 ] = _rtB -> B_6_39_360 [ 0 ] ; } _rtB -> B_6_39_360 [ 0 ] = _rtDW -> INPUT_1_1_1_Discrete_1347933324 [ 1 ] ; _rtB -> B_6_39_360 [ 3 ] = _rtDW -> INPUT_1_1_1_Discrete_1347933324 [ 0 ] ; _rtB -> B_6_43_392 = 0.0 ; _rtB -> B_6_43_392 += _rtP -> P_72 * _rtX -> TransferFcn_CSTATE_i ; _rtB -> B_6_44_400 = _rtP -> P_73 * _rtB -> B_6_43_392 ; _rtB -> B_6_0_0 . re = _rtB -> B_6_44_400 ; _rtB -> B_6_0_0 . im = _rtB -> B_6_212_1744 ; _rtB -> B_6_45_408 = 0.0 ; _rtB -> B_6_45_408 += _rtP -> P_75 * _rtX -> Sensordynamics2_CSTATE ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_45_408 >= _rtP -> P_76 ) { _rtDW -> Saturation_MODE_e = 1 ; } else if ( _rtB -> B_6_45_408 > _rtP -> P_77 ) { _rtDW -> Saturation_MODE_e = 0 ; } else { _rtDW -> Saturation_MODE_e = - 1 ; } } if ( _rtDW -> Saturation_MODE_e == 1 ) { _rtB -> B_6_46_416 = _rtP -> P_76 ; } else if ( _rtDW -> Saturation_MODE_e == - 1 ) { _rtB -> B_6_46_416 = _rtP -> P_77 ; } else { _rtB -> B_6_46_416 = _rtB -> B_6_45_408 ; } if ( _rtB -> B_6_0_0 . im == 0.0 ) { _rtB -> B_6_1_16 . re = _rtB -> B_6_0_0 . re / _rtB -> B_6_46_416 ; _rtB -> B_6_1_16 . im = 0.0 ; } else if ( _rtB -> B_6_0_0 . re == 0.0 ) { _rtB -> B_6_1_16 . re = 0.0 ; _rtB -> B_6_1_16 . im = _rtB -> B_6_0_0 . im / _rtB -> B_6_46_416 ; } else { _rtB -> B_6_1_16 . re = _rtB -> B_6_0_0 . re / _rtB -> B_6_46_416 ; _rtB -> B_6_1_16 . im = _rtB -> B_6_0_0 . im / _rtB -> B_6_46_416 ; } _rtB -> B_6_2_32 . re = _rtP -> P_78 * _rtB -> B_6_1_16 . re ; _rtB -> B_6_2_32 . im = _rtP -> P_78 * - _rtB -> B_6_1_16 . im ; _rtB -> B_6_3_48 . re = _rtB -> B_6_1_16 . re * _rtB -> B_6_5_80 . re - - _rtB -> B_6_1_16 . im * _rtB -> B_6_5_80 . im ; _rtB -> B_6_3_48 . im = _rtB -> B_6_1_16 . re * _rtB -> B_6_5_80 . im + - _rtB -> B_6_1_16 . im * _rtB -> B_6_5_80 . re ; _rtB -> B_6_4_64 . re = ( _rtB -> B_6_2_32 . re + _rtB -> B_6_46_416 ) + _rtB -> B_6_3_48 . re ; _rtB -> B_6_4_64 . im = _rtB -> B_6_2_32 . im + _rtB -> B_6_3_48 . im ; rtb_B_6_246_1984 = muDoubleScalarHypot ( _rtB -> B_6_4_64 . re , _rtB -> B_6_4_64 . im ) ; rtb_B_6_247_1992 = muDoubleScalarAtan2 ( _rtB -> B_6_4_64 . im , _rtB -> B_6_4_64 . re ) ; _rtB -> B_6_47_424 = 0.0 ; _rtB -> B_6_47_424 += _rtP -> P_80 * _rtX -> Sensordynamics1_CSTATE ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> Compare_Mode_b = ( _rtB -> B_6_47_424 >= sscv_wind_turbine_rtC ( S ) -> B_6_262_2096 ) ; } _rtB -> B_6_241_1941 = _rtDW -> Compare_Mode_b ; } if ( ssIsModeUpdateTimeStep ( S ) ) { limitedCache = ( _rtB -> B_6_241_1941 && ( _rtZCE -> Integrator_Reset_ZCE != POS_ZCSIG ) ) ; _rtZCE -> Integrator_Reset_ZCE = _rtB -> B_6_241_1941 ; if ( limitedCache || _rtDW -> Integrator_DWORK1 ) { limitedCache = ( _rtX -> Integrator_CSTATE != _rtB -> B_6_209_1720 ) ; _rtX -> Integrator_CSTATE = _rtB -> B_6_209_1720 ; if ( ( _rtX -> Integrator_CSTATE < 0.0 ) || ( _rtX -> Integrator_CSTATE >= 6.2831853071795862 ) ) { riseValLimit = muDoubleScalarFloor ( _rtX -> Integrator_CSTATE / 6.2831853071795862 ) ; if ( riseValLimit != 0.0 ) { _rtX -> Integrator_CSTATE -= riseValLimit * 6.2831853071795862 ; } } if ( limitedCache ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } } _rtB -> B_6_48_432 = _rtX -> Integrator_CSTATE ; } else { _rtB -> B_6_48_432 = _rtX -> Integrator_CSTATE ; } _rtB -> B_6_49_440 = _rtP -> P_81 * _rtB -> B_6_48_432 ; _rtB -> B_6_50_448 = rtb_B_6_247_1992 + _rtB -> B_6_49_440 ; _rtB -> B_6_51_456 = _rtB -> B_6_50_448 + _rtP -> P_82 ; _rtB -> B_6_52_464 = _rtB -> B_6_50_448 + _rtP -> P_83 ; _rtB -> B_6_53_472 [ 0 ] = _rtB -> B_6_50_448 ; _rtB -> B_6_53_472 [ 1 ] = _rtB -> B_6_51_456 ; _rtB -> B_6_53_472 [ 2 ] = _rtB -> B_6_52_464 ; _rtB -> B_6_56_496 [ 0 ] = rtb_B_6_246_1984 * muDoubleScalarSin ( _rtB -> B_6_53_472 [ 0 ] ) ; _rtB -> B_6_56_496 [ 1 ] = rtb_B_6_246_1984 * muDoubleScalarSin ( _rtB -> B_6_53_472 [ 1 ] ) ; _rtB -> B_6_56_496 [ 2 ] = rtb_B_6_246_1984 * muDoubleScalarSin ( _rtB -> B_6_53_472 [ 2 ] ) ; _rtB -> B_6_59_520 [ 0 ] = _rtB -> B_6_56_496 [ 0 ] ; _rtB -> B_6_59_520 [ 1 ] = 0.0 ; _rtB -> B_6_59_520 [ 2 ] = 0.0 ; _rtB -> B_6_59_520 [ 3 ] = 0.0 ; _rtB -> B_6_63_552 [ 0 ] = _rtB -> B_6_56_496 [ 1 ] ; _rtB -> B_6_63_552 [ 1 ] = 0.0 ; _rtB -> B_6_63_552 [ 2 ] = 0.0 ; _rtB -> B_6_63_552 [ 3 ] = 0.0 ; _rtB -> B_6_67_584 [ 0 ] = _rtB -> B_6_56_496 [ 2 ] ; _rtB -> B_6_67_584 [ 1 ] = 0.0 ; _rtB -> B_6_67_584 [ 2 ] = 0.0 ; _rtB -> B_6_67_584 [ 3 ] = 0.0 ; ssCallAccelRunBlock ( S , 6 , 91 , SS_CALL_MDL_OUTPUTS ) ; ssCallAccelRunBlock ( S , 6 , 92 , SS_CALL_MDL_OUTPUTS ) ; ssCallAccelRunBlock ( S , 6 , 93 , SS_CALL_MDL_OUTPUTS ) ; if ( _rtDW -> INPUT_2_1_1_FirstOutput_2123895232 == 0.0 ) { _rtDW -> INPUT_2_1_1_FirstOutput_2123895232 = 1.0 ; _rtX -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 = _rtB -> B_6_11_136 ; } _rtB -> B_6_100_848 [ 0 ] = _rtX -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 ; _rtB -> B_6_100_848 [ 1 ] = ( _rtB -> B_6_11_136 - _rtX -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 ) * 1000.0 ; _rtB -> B_6_100_848 [ 2 ] = 0.0 ; _rtB -> B_6_100_848 [ 3 ] = 0.0 ; if ( _rtDW -> INPUT_1_1_1_FirstOutput_959998736 == 0.0 ) { _rtDW -> INPUT_1_1_1_FirstOutput_959998736 = 1.0 ; _rtX -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 = _rtB -> B_6_37_344 ; } _rtB -> B_6_104_880 [ 0 ] = _rtX -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 ; _rtB -> B_6_104_880 [ 1 ] = ( _rtB -> B_6_37_344 - _rtX -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 ) * 1000.0 ; _rtB -> B_6_104_880 [ 2 ] = 0.0 ; _rtB -> B_6_104_880 [ 3 ] = 0.0 ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { _rtB -> B_6_108_912 = _rtP -> P_84 * _rtB -> B_5_214_1760 ; } _rtB -> B_6_109_920 [ 0 ] = _rtB -> B_6_108_912 ; _rtB -> B_6_109_920 [ 1 ] = 0.0 ; _rtB -> B_6_109_920 [ 2 ] = 0.0 ; if ( ssIsMajorTimeStep ( S ) != 0 ) { _rtDW -> INPUT_3_1_1_Discrete_1140340848 [ 0 ] = ! ( _rtB -> B_6_109_920 [ 0 ] == _rtDW -> INPUT_3_1_1_Discrete_1140340848 [ 1 ] ) ; _rtDW -> INPUT_3_1_1_Discrete_1140340848 [ 1 ] = _rtB -> B_6_109_920 [ 0 ] ; } _rtB -> B_6_109_920 [ 0 ] = _rtDW -> INPUT_3_1_1_Discrete_1140340848 [ 1 ] ; _rtB -> B_6_109_920 [ 3 ] = _rtDW -> INPUT_3_1_1_Discrete_1140340848 [ 0 ] ; _rtB -> B_6_113_952 = 0.0 ; _rtB -> B_6_113_952 += _rtP -> P_86 * _rtX -> TransferFcn_CSTATE_k ; _rtB -> B_6_114_960 = 0.0 ; _rtB -> B_6_114_960 += _rtP -> P_88 * _rtX -> TransferFcn2_CSTATE ; if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_114_960 >= _rtP -> P_89 ) { _rtDW -> Saturation_MODE_a = 1 ; } else if ( _rtB -> B_6_114_960 > _rtP -> P_90 ) { _rtDW -> Saturation_MODE_a = 0 ; } else { _rtDW -> Saturation_MODE_a = - 1 ; } } if ( _rtDW -> Saturation_MODE_a == 1 ) { _rtB -> B_6_115_968 = _rtP -> P_89 ; } else if ( _rtDW -> Saturation_MODE_a == - 1 ) { _rtB -> B_6_115_968 = _rtP -> P_90 ; } else { _rtB -> B_6_115_968 = _rtB -> B_6_114_960 ; } _rtB -> B_6_116_976 = _rtB -> B_6_113_952 / _rtB -> B_6_115_968 ; if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> Abs_MODE = ( _rtB -> B_6_116_976 >= 0.0 ) ; } if ( _rtDW -> Abs_MODE > 0 ) { _rtB -> B_6_117_984 = _rtB -> B_6_116_976 ; } else { _rtB -> B_6_117_984 = - _rtB -> B_6_116_976 ; } if ( _rtB -> B_5_215_1768 > _rtP -> P_91 ) { _rtB -> B_6_118_992 = _rtB -> B_6_207_1704 ; } else { _rtB -> B_6_118_992 = _rtB -> B_6_117_984 ; } _rtB -> B_6_119_1000 [ 0 ] = _rtB -> B_6_118_992 ; _rtB -> B_6_119_1000 [ 1 ] = 0.0 ; _rtB -> B_6_119_1000 [ 2 ] = 0.0 ; _rtB -> B_6_119_1000 [ 3 ] = 0.0 ; ssCallAccelRunBlock ( S , 6 , 106 , SS_CALL_MDL_OUTPUTS ) ; ssCallAccelRunBlock ( S , 6 , 107 , SS_CALL_MDL_OUTPUTS ) ; ssCallAccelRunBlock ( S , 6 , 108 , SS_CALL_MDL_OUTPUTS ) ; _rtB -> B_6_173_1432 = 0.0 ; _rtB -> B_6_173_1432 += _rtP -> P_93 * _rtX -> TransferFcn1_CSTATE_c ; _rtB -> B_6_174_1440 = _rtB -> B_6_173_1432 / _rtB -> B_6_115_968 ; _rtB -> B_6_175_1448 = _rtP -> P_94 * _rtB -> B_6_16_176 ; _rtB -> B_6_176_1456 = _rtP -> P_95 * _rtB -> B_6_20_208 ; _rtB -> B_6_177_1464 = _rtP -> P_96 * _rtB -> B_6_170_1408 [ 1 ] ; if ( ssIsModeUpdateTimeStep ( S ) ) { limitedCache = _rtDW -> Integrator_DWORK1_n ; zcEvent = rt_ZCFcn ( ANY_ZERO_CROSSING , & _rtZCE -> Integrator_Reset_ZCE_o , _rtB -> B_6_210_1728 ) ; resetX = ( ( _rtB -> B_6_210_1728 != 0.0 ) || ( zcEvent != NO_ZCEVENT ) ) ; if ( resetX ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } resetX = ( resetX || limitedCache ) ; if ( resetX ) { limitedCache = ( _rtX -> Integrator_CSTATE_i != _rtB -> B_6_211_1736 ) ; _rtX -> Integrator_CSTATE_i = _rtB -> B_6_211_1736 ; if ( limitedCache ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } } if ( _rtX -> Integrator_CSTATE_i >= _rtP -> P_97 ) { if ( _rtX -> Integrator_CSTATE_i != _rtP -> P_97 ) { _rtX -> Integrator_CSTATE_i = _rtP -> P_97 ; ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } _rtDW -> Integrator_MODE = 3 ; } else if ( _rtX -> Integrator_CSTATE_i <= _rtP -> P_98 ) { if ( _rtX -> Integrator_CSTATE_i != _rtP -> P_98 ) { _rtX -> Integrator_CSTATE_i = _rtP -> P_98 ; ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } _rtDW -> Integrator_MODE = 4 ; } else { if ( _rtDW -> Integrator_MODE != 0 ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } _rtDW -> Integrator_MODE = 0 ; } _rtB -> B_6_178_1472 = _rtX -> Integrator_CSTATE_i ; } else { _rtB -> B_6_178_1472 = _rtX -> Integrator_CSTATE_i ; } if ( ssIsModeUpdateTimeStep ( S ) ) { if ( _rtB -> B_6_178_1472 >= _rtP -> P_99 ) { _rtDW -> Saturation_MODE_c = 1 ; } else if ( _rtB -> B_6_178_1472 > _rtP -> P_100 ) { _rtDW -> Saturation_MODE_c = 0 ; } else { _rtDW -> Saturation_MODE_c = - 1 ; } } if ( _rtDW -> Saturation_MODE_c == 1 ) { _rtB -> B_6_179_1480 = _rtP -> P_99 ; } else if ( _rtDW -> Saturation_MODE_c == - 1 ) { _rtB -> B_6_179_1480 = _rtP -> P_100 ; } else { _rtB -> B_6_179_1480 = _rtB -> B_6_178_1472 ; } _rtB -> B_6_180_1488 = sscv_wind_turbine_acc_rt_TDelayInterpolate ( ssGetT ( S ) - _rtP -> P_101 , _rtDW -> TransportDelay_RWORK , ( real_T * ) _rtDW -> TransportDelay_PWORK [ 0 ] , _rtDW -> TransportDelay_IWORK [ 3 ] , & _rtDW -> TransportDelay_IWORK [ 2 ] , _rtDW -> TransportDelay_IWORK [ 0 ] , _rtDW -> TransportDelay_IWORK [ 1 ] , _rtP -> P_102 , false , ( ssIsMinorTimeStep ( S ) != 0 ) && ( ( ( real_T * ) _rtDW -> TransportDelay_PWORK [ 0 ] ) [ _rtDW -> TransportDelay_IWORK [ 1 ] + _rtDW -> TransportDelay_IWORK [ 3 ] ] == ssGetT ( S ) ) ) ; _rtB -> B_6_181_1496 = _rtB -> B_6_179_1480 - _rtB -> B_6_180_1488 ; _rtB -> B_6_182_1504 = _rtP -> P_103 * _rtB -> B_6_181_1496 ; if ( ssIsModeUpdateTimeStep ( S ) ) { _rtDW -> Abs_MODE_p = ( _rtB -> B_6_182_1504 >= 0.0 ) ; } if ( _rtDW -> Abs_MODE_p > 0 ) { _rtB -> B_6_183_1512 = _rtB -> B_6_182_1504 ; } else { _rtB -> B_6_183_1512 = - _rtB -> B_6_182_1504 ; } if ( ssIsMajorTimeStep ( S ) != 0 ) { if ( _rtDW -> Sqrt_DWORK1 != 0 ) { ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; ssSetContTimeOutputInconsistentWithStateAtMajorStep ( S ) ; _rtDW -> Sqrt_DWORK1 = 0 ; } rtb_B_6_246_1984 = muDoubleScalarSqrt ( _rtB -> B_6_183_1512 ) ; } else if ( _rtB -> B_6_183_1512 < 0.0 ) { rtb_B_6_246_1984 = - muDoubleScalarSqrt ( muDoubleScalarAbs ( _rtB -> B_6_183_1512 ) ) ; _rtDW -> Sqrt_DWORK1 = 1 ; } else { rtb_B_6_246_1984 = muDoubleScalarSqrt ( _rtB -> B_6_183_1512 ) ; } _rtB -> B_6_184_1520 = _rtP -> P_104 * rtb_B_6_246_1984 ; if ( ( _rtDW -> IC_FirstOutputTime == ( rtMinusInf ) ) || ( _rtDW -> IC_FirstOutputTime == ssGetTaskTime ( S , 0 ) ) ) { _rtDW -> IC_FirstOutputTime = ssGetTaskTime ( S , 0 ) ; rtb_B_6_246_1984 = _rtP -> P_105 ; } else { rtb_B_6_246_1984 = _rtB -> B_6_47_424 ; } _rtB -> B_6_185_1528 = rtb_B_6_246_1984 * rtb_B_6_246_1984 ; isHit = ssIsSampleHit ( S , 1 , 0 ) ; if ( isHit != 0 ) { { if ( _rtDW -> TAQSigLogging_InsertedFor_MeasurementFilter_at_outport_0_PWORK . AQHandles && ssGetLogOutput ( S ) ) { sdiWriteSignal ( _rtDW -> TAQSigLogging_InsertedFor_MeasurementFilter_at_outport_0_PWORK . AQHandles , ssGetTaskTime ( S , 1 ) , ( char * ) & _rtB -> B_6_7_104 + 0 ) ; } } } UNUSED_PARAMETER ( tid ) ; } static void mdlOutputsTID2 ( SimStruct * S , int_T tid ) { B_sscv_wind_turbine_T * _rtB ; DW_sscv_wind_turbine_T * _rtDW ; P_sscv_wind_turbine_T * _rtP ; _rtDW = ( ( DW_sscv_wind_turbine_T * ) ssGetRootDWork ( S ) ) ; _rtP = ( ( P_sscv_wind_turbine_T * ) ssGetModelRtp ( S ) ) ; _rtB = ( ( B_sscv_wind_turbine_T * ) _ssGetModelBlockIO ( S ) ) ; _rtB -> B_6_186_1536 = _rtP -> P_108 ; _rtB -> B_6_187_1544 = _rtP -> P_109 ; _rtB -> B_0_234_1920 = _rtP -> P_4 ; _rtB -> B_0_235_1928 = _rtP -> P_5 ; if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> TurbineState0an3_SubsysRanBC ) ; } _rtB -> B_6_188_1552 = _rtP -> P_110 ; _rtB -> B_1_231_1896 = _rtP -> P_10 ; if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> TurbineState1_SubsysRanBC ) ; } _rtB -> B_6_189_1560 = _rtP -> P_111 ; _rtB -> B_2_228_1872 = _rtP -> P_23 ; _rtB -> B_2_229_1880 = _rtP -> P_24 ; if ( ssIsModeUpdateTimeStep ( S ) ) { srUpdateBC ( _rtDW -> TurbineState2_SubsysRanBC ) ; } _rtB -> B_3_217_1784 = _rtP -> P_27 * _rtP -> P_26 ; _rtB -> B_3_218_1792 = _rtP -> P_28 ; _rtB -> B_6_190_1568 = _rtP -> P_112 ; _rtB -> B_6_191_1576 = _rtP -> P_113 ; _rtB -> B_6_192_1584 = _rtP -> P_114 ; _rtB -> B_6_193_1592 = _rtP -> P_115 ; _rtB -> B_6_194_1600 = _rtP -> P_116 ; _rtB -> B_6_195_1608 = _rtP -> P_117 ; _rtB -> B_6_196_1616 = _rtP -> P_118 ; _rtB -> B_6_197_1624 = _rtP -> P_119 ; _rtB -> B_6_198_1632 = _rtP -> P_120 ; _rtB -> B_6_199_1640 = _rtP -> P_121 ; _rtB -> B_6_200_1648 = _rtP -> P_122 ; _rtB -> B_6_201_1656 = _rtP -> P_123 ; _rtB -> B_6_202_1664 = _rtP -> P_124 ; _rtB -> B_6_203_1672 = _rtP -> P_125 ; _rtB -> B_6_204_1680 = _rtP -> P_126 ; _rtB -> B_6_205_1688 = _rtP -> P_127 ; ssCallAccelRunBlock ( S , 6 , 199 , SS_CALL_MDL_OUTPUTS ) ; _rtB -> B_6_207_1704 = _rtP -> P_128 ; _rtB -> B_6_208_1712 = _rtP -> P_129 ; _rtB -> B_6_209_1720 = _rtP -> P_130 ; _rtB -> B_6_210_1728 = _rtP -> P_131 ; _rtB -> B_6_211_1736 = _rtP -> P_132 ; _rtB -> B_6_5_80 . re = _rtP -> P_134 ; _rtB -> B_6_5_80 . im = _rtP -> P_135 * _rtP -> P_133 ; _rtB -> B_6_212_1744 = _rtP -> P_136 ; UNUSED_PARAMETER ( tid ) ; }
#define MDL_UPDATE
static void mdlUpdate ( SimStruct * S , int_T tid ) { B_sscv_wind_turbine_T *
_rtB ; DW_sscv_wind_turbine_T * _rtDW ; P_sscv_wind_turbine_T * _rtP ;
XDis_sscv_wind_turbine_T * _rtXdis ; _rtDW = ( ( DW_sscv_wind_turbine_T * )
ssGetRootDWork ( S ) ) ; _rtXdis = ( ( XDis_sscv_wind_turbine_T * )
ssGetContStateDisabled ( S ) ) ; _rtP = ( ( P_sscv_wind_turbine_T * )
ssGetModelRtp ( S ) ) ; _rtB = ( ( B_sscv_wind_turbine_T * )
_ssGetModelBlockIO ( S ) ) ; _rtDW -> PrevY = _rtB -> B_6_11_136 ; _rtDW ->
LastMajorTime = ssGetTaskTime ( S , 0 ) ; _rtDW -> Integrator_DWORK1 = false
; ssCallAccelRunBlock ( S , 6 , 91 , SS_CALL_MDL_UPDATE ) ;
ssCallAccelRunBlock ( S , 6 , 106 , SS_CALL_MDL_UPDATE ) ; _rtDW ->
Integrator_DWORK1_n = false ; switch ( _rtDW -> Integrator_MODE ) { case 3 :
if ( _rtB -> B_6_185_1528 < 0.0 ) { _rtDW -> Integrator_MODE = 1 ;
ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } break ; case 4 : if ( _rtB
-> B_6_185_1528 > 0.0 ) { _rtDW -> Integrator_MODE = 2 ;
ssSetBlockStateForSolverChangedAtMajorStep ( S ) ; } break ; } _rtXdis ->
Integrator_CSTATE_i = ( ( _rtDW -> Integrator_MODE == 3 ) || ( _rtDW ->
Integrator_MODE == 4 ) ) ; if ( _rtDW -> TransportDelay_IWORK [ 1 ] < _rtDW
-> TransportDelay_IWORK [ 3 ] - 1 ) { _rtDW -> TransportDelay_IWORK [ 1 ] ++
; } else { _rtDW -> TransportDelay_IWORK [ 1 ] = 0 ; } if ( _rtDW ->
TransportDelay_IWORK [ 0 ] == _rtDW -> TransportDelay_IWORK [ 1 ] ) {
rt_TDelayUpdateTailOrGrowBuf ( & _rtDW -> TransportDelay_IWORK [ 3 ] , &
_rtDW -> TransportDelay_IWORK [ 0 ] , & _rtDW -> TransportDelay_IWORK [ 1 ] ,
& _rtDW -> TransportDelay_IWORK [ 2 ] , ssGetT ( S ) - _rtP -> P_101 , ( real_T
* * ) & _rtDW -> TransportDelay_PWORK [ 0 ] , false , false , & _rtDW ->
TransportDelay_IWORK [ 4 ] ) ; } ( ( real_T * ) _rtDW -> TransportDelay_PWORK
[ 0 ] ) [ _rtDW -> TransportDelay_IWORK [ 1 ] ] = _rtB -> B_6_179_1480 ; ( ( real_T * ) _rtDW -> TransportDelay_PWORK [ 0 ] ) [ _rtDW -> TransportDelay_IWORK [ 1 ] + _rtDW -> TransportDelay_IWORK [ 3 ] ] = ssGetT ( S ) ; UNUSED_PARAMETER ( tid ) ; }
#define MDL_UPDATE
static void mdlUpdateTID2 ( SimStruct * S , int_T tid ) { UNUSED_PARAMETER ( tid
) ; }
#define MDL_DERIVATIVES
static void mdlDerivatives ( SimStruct * S ) { B_sscv_wind_turbine_T * _rtB ;
DW_sscv_wind_turbine_T * _rtDW ; P_sscv_wind_turbine_T * _rtP ;
XDis_sscv_wind_turbine_T * _rtXdis ; XDot_sscv_wind_turbine_T * _rtXdot ;
X_sscv_wind_turbine_T * _rtX ; _rtDW = ( ( DW_sscv_wind_turbine_T * )
ssGetRootDWork ( S ) ) ; _rtXdis = ( ( XDis_sscv_wind_turbine_T * )
ssGetContStateDisabled ( S ) ) ; _rtXdot = ( ( XDot_sscv_wind_turbine_T * )
ssGetdX ( S ) ) ; _rtX = ( ( X_sscv_wind_turbine_T * ) ssGetContStates ( S )
) ; _rtP = ( ( P_sscv_wind_turbine_T * ) ssGetModelRtp ( S ) ) ; _rtB = ( ( B_sscv_wind_turbine_T * ) _ssGetModelBlockIO ( S ) ) ; _rtXdot -> MeasurementFilter_CSTATE = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE += _rtP -> P_35 * _rtX -> MeasurementFilter_CSTATE ; _rtXdot -> MeasurementFilter_CSTATE += _rtB -> B_6_37_344 ; _rtXdot -> MeasurementFilter_CSTATE_f = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE_f += _rtP -> P_37 * _rtX -> MeasurementFilter_CSTATE_f ; _rtXdot -> MeasurementFilter_CSTATE_f += _rtB -> B_6_170_1408 [ 2 ] ; _rtXdot -> TransferFcn1_CSTATE = 0.0 ; _rtXdot -> TransferFcn1_CSTATE += _rtP -> P_39 * _rtX -> TransferFcn1_CSTATE ; _rtXdot -> TransferFcn1_CSTATE += _rtB -> B_6_10_128 ; if ( _rtDW -> TurbineState0an3_MODE ) { _rtXdot -> Controller_CSTATE = 0.0 ; _rtXdot -> Controller_CSTATE += _rtP -> P_0 * _rtX -> Controller_CSTATE ; _rtXdot -> Controller_CSTATE += _rtB -> B_0_234_1920 ; _rtXdot -> Integrator_CSTATE_b = _rtB -> B_0_235_1928 ; } else { { real_T * dx ; int_T i1 ; dx = & ( ( ( XDot_sscv_wind_turbine_T * ) ssGetdX ( S ) ) -> Controller_CSTATE ) ; for ( i1 = 0 ; i1 < 2 ; i1 ++ ) { dx [ i1 ] = 0.0 ; } } } if ( _rtDW -> TurbineState1_MODE ) { _rtXdot -> TransferFcn_CSTATE_io = 0.0 ; _rtXdot -> TransferFcn_CSTATE_io += _rtP -> P_6 * _rtX -> TransferFcn_CSTATE_io ; _rtXdot -> TransferFcn_CSTATE_io += _rtB -> B_1_231_1896 ; } else { ( ( XDot_sscv_wind_turbine_T * ) ssGetdX ( S ) ) -> TransferFcn_CSTATE_io = 0.0 ; } _rtXdot -> MeasurementFilter_CSTATE_a = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE_a += _rtP -> P_41 * _rtX -> MeasurementFilter_CSTATE_a ; _rtXdot -> MeasurementFilter_CSTATE_a += _rtB -> B_6_96_816 [ 3 ] ; if ( _rtDW -> TurbineState2_MODE ) { _rtXdot -> Integrator_CSTATE_g = _rtB -> B_2_226_1856 ; _rtXdot -> TransferFcn_CSTATE_b = 0.0 ; _rtXdot -> TransferFcn_CSTATE_b += _rtP -> P_19 * _rtX -> TransferFcn_CSTATE_b ; _rtXdot -> TransferFcn_CSTATE_b += _rtB -> B_2_225_1848 ; } else { { real_T * dx ; int_T i1 ; dx = & ( ( ( XDot_sscv_wind_turbine_T * ) ssGetdX ( S ) ) -> Integrator_CSTATE_g ) ; for ( i1 = 0 ; i1 < 2 ; i1 ++ ) { dx [ i1 ] = 0.0 ; } } } _rtXdot -> TransferFcn_CSTATE = 0.0 ; _rtXdot -> TransferFcn_CSTATE += _rtP -> P_49 * _rtX -> TransferFcn_CSTATE ; _rtXdot -> TransferFcn_CSTATE += _rtB -> B_6_17_184 ; _rtXdot -> TransferFcn_CSTATE_l = 0.0 ; _rtXdot -> TransferFcn_CSTATE_l += _rtP -> P_53 * _rtX -> TransferFcn_CSTATE_l ; _rtXdot -> TransferFcn_CSTATE_l += _rtB -> B_6_21_216 ; _rtXdot -> TransferFcn_CSTATE_i = 0.0 ; _rtXdot -> TransferFcn_CSTATE_i += _rtP -> P_71 * _rtX -> TransferFcn_CSTATE_i ; _rtXdot -> TransferFcn_CSTATE_i += _rtB -> B_6_177_1464 ; _rtXdot -> Sensordynamics2_CSTATE = 0.0 ; _rtXdot -> Sensordynamics2_CSTATE += _rtP -> P_74 * _rtX -> Sensordynamics2_CSTATE ; _rtXdot -> Sensordynamics2_CSTATE += _rtB -> B_6_184_1520 ; _rtXdot -> Sensordynamics1_CSTATE = 0.0 ; _rtXdot -> Sensordynamics1_CSTATE += _rtP -> P_79 * _rtX -> Sensordynamics1_CSTATE ; _rtXdot -> Sensordynamics1_CSTATE += _rtB -> B_6_96_816 [ 0 ] ; _rtXdot -> Integrator_CSTATE = _rtB -> B_6_208_1712 ; ssCallAccelRunBlock ( S , 6 , 91 , SS_CALL_MDL_DERIVATIVES ) ; _rtXdot -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 = ( _rtB -> B_6_11_136 - _rtX -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 ) * 1000.0 ; _rtXdot -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 = ( _rtB -> B_6_37_344 - _rtX -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 ) * 1000.0 ; _rtXdot -> TransferFcn_CSTATE_k = 0.0 ; _rtXdot -> TransferFcn_CSTATE_k += _rtP -> P_85 * _rtX -> TransferFcn_CSTATE_k ; _rtXdot -> TransferFcn_CSTATE_k += _rtB -> B_6_174_1440 ; _rtXdot -> TransferFcn2_CSTATE = 0.0 ; _rtXdot -> TransferFcn2_CSTATE += _rtP -> P_87 * _rtX -> TransferFcn2_CSTATE ; _rtXdot -> TransferFcn2_CSTATE += _rtB -> B_6_176_1456 ; ssCallAccelRunBlock ( S , 6 , 106 , SS_CALL_MDL_DERIVATIVES ) ; _rtXdot -> TransferFcn1_CSTATE_c = 0.0 ; _rtXdot -> TransferFcn1_CSTATE_c += _rtP -> P_92 * _rtX -> TransferFcn1_CSTATE_c ; _rtXdot -> TransferFcn1_CSTATE_c += _rtB -> B_6_175_1448 ; if ( _rtXdis -> Integrator_CSTATE_i ) { _rtXdot -> Integrator_CSTATE_i = 0.0 ; } else if ( _rtB -> B_6_210_1728 != 0.0 ) { _rtXdot -> Integrator_CSTATE_i = 0.0 ; } else { _rtXdot -> Integrator_CSTATE_i = _rtB -> B_6_185_1528 ; } _rtXdot -> MeasurementFilter_CSTATE_d = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE_d += _rtP -> P_106 * _rtX -> MeasurementFilter_CSTATE_d ; _rtXdot -> MeasurementFilter_CSTATE_d += _rtB -> B_6_170_1408 [ 0 ] ; }
#define MDL_PROJECTION
static void mdlProjection ( SimStruct * S ) { ssCallAccelRunBlock ( S , 6 ,
91 , SS_CALL_MDL_PROJECTION ) ; ssCallAccelRunBlock ( S , 6 , 106 ,
SS_CALL_MDL_PROJECTION ) ; }
#define MDL_FORCINGFUNCTION
static void mdlForcingFunction ( SimStruct * S ) { B_sscv_wind_turbine_T *
_rtB ; DW_sscv_wind_turbine_T * _rtDW ; P_sscv_wind_turbine_T * _rtP ;
XDis_sscv_wind_turbine_T * _rtXdis ; XDot_sscv_wind_turbine_T * _rtXdot ;
X_sscv_wind_turbine_T * _rtX ; _rtDW = ( ( DW_sscv_wind_turbine_T * )
ssGetRootDWork ( S ) ) ; _rtXdis = ( ( XDis_sscv_wind_turbine_T * )
ssGetContStateDisabled ( S ) ) ; _rtXdot = ( ( XDot_sscv_wind_turbine_T * )
ssGetdX ( S ) ) ; _rtX = ( ( X_sscv_wind_turbine_T * ) ssGetContStates ( S )
) ; _rtP = ( ( P_sscv_wind_turbine_T * ) ssGetModelRtp ( S ) ) ; _rtB = ( ( B_sscv_wind_turbine_T * ) _ssGetModelBlockIO ( S ) ) ; _rtXdot -> MeasurementFilter_CSTATE = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE += _rtP -> P_35 * _rtX -> MeasurementFilter_CSTATE ; _rtXdot -> MeasurementFilter_CSTATE += _rtB -> B_6_37_344 ; _rtXdot -> MeasurementFilter_CSTATE_f = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE_f += _rtP -> P_37 * _rtX -> MeasurementFilter_CSTATE_f ; _rtXdot -> MeasurementFilter_CSTATE_f += _rtB -> B_6_170_1408 [ 2 ] ; _rtXdot -> TransferFcn1_CSTATE = 0.0 ; _rtXdot -> TransferFcn1_CSTATE += _rtP -> P_39 * _rtX -> TransferFcn1_CSTATE ; _rtXdot -> TransferFcn1_CSTATE += _rtB -> B_6_10_128 ; if ( _rtDW -> TurbineState0an3_MODE ) { _rtXdot -> Controller_CSTATE = 0.0 ; _rtXdot -> Controller_CSTATE += _rtP -> P_0 * _rtX -> Controller_CSTATE ; _rtXdot -> Controller_CSTATE += _rtB -> B_0_234_1920 ; _rtXdot -> Integrator_CSTATE_b = _rtB -> B_0_235_1928 ; } else { { real_T * dx ; int_T i1 ; dx = & ( ( ( XDot_sscv_wind_turbine_T * ) ssGetdX ( S ) ) -> Controller_CSTATE ) ; for ( i1 = 0 ; i1 < 2 ; i1 ++ ) { dx [ i1 ] = 0.0 ; } } } if ( _rtDW -> TurbineState1_MODE ) { _rtXdot -> TransferFcn_CSTATE_io = 0.0 ; _rtXdot -> TransferFcn_CSTATE_io += _rtP -> P_6 * _rtX -> TransferFcn_CSTATE_io ; _rtXdot -> TransferFcn_CSTATE_io += _rtB -> B_1_231_1896 ; } else { ( ( XDot_sscv_wind_turbine_T * ) ssGetdX ( S ) ) -> TransferFcn_CSTATE_io = 0.0 ; } _rtXdot -> MeasurementFilter_CSTATE_a = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE_a += _rtP -> P_41 * _rtX -> MeasurementFilter_CSTATE_a ; _rtXdot -> MeasurementFilter_CSTATE_a += _rtB -> B_6_96_816 [ 3 ] ; if ( _rtDW -> TurbineState2_MODE ) { _rtXdot -> Integrator_CSTATE_g = _rtB -> B_2_226_1856 ; _rtXdot -> TransferFcn_CSTATE_b = 0.0 ; _rtXdot -> TransferFcn_CSTATE_b += _rtP -> P_19 * _rtX -> TransferFcn_CSTATE_b ; _rtXdot -> TransferFcn_CSTATE_b += _rtB -> B_2_225_1848 ; } else { { real_T * dx ; int_T i1 ; dx = & ( ( ( XDot_sscv_wind_turbine_T * ) ssGetdX ( S ) ) -> Integrator_CSTATE_g ) ; for ( i1 = 0 ; i1 < 2 ; i1 ++ ) { dx [ i1 ] = 0.0 ; } } } _rtXdot -> TransferFcn_CSTATE = 0.0 ; _rtXdot -> TransferFcn_CSTATE += _rtP -> P_49 * _rtX -> TransferFcn_CSTATE ; _rtXdot -> TransferFcn_CSTATE += _rtB -> B_6_17_184 ; _rtXdot -> TransferFcn_CSTATE_l = 0.0 ; _rtXdot -> TransferFcn_CSTATE_l += _rtP -> P_53 * _rtX -> TransferFcn_CSTATE_l ; _rtXdot -> TransferFcn_CSTATE_l += _rtB -> B_6_21_216 ; _rtXdot -> TransferFcn_CSTATE_i = 0.0 ; _rtXdot -> TransferFcn_CSTATE_i += _rtP -> P_71 * _rtX -> TransferFcn_CSTATE_i ; _rtXdot -> TransferFcn_CSTATE_i += _rtB -> B_6_177_1464 ; _rtXdot -> Sensordynamics2_CSTATE = 0.0 ; _rtXdot -> Sensordynamics2_CSTATE += _rtP -> P_74 * _rtX -> Sensordynamics2_CSTATE ; _rtXdot -> Sensordynamics2_CSTATE += _rtB -> B_6_184_1520 ; _rtXdot -> Sensordynamics1_CSTATE = 0.0 ; _rtXdot -> Sensordynamics1_CSTATE += _rtP -> P_79 * _rtX -> Sensordynamics1_CSTATE ; _rtXdot -> Sensordynamics1_CSTATE += _rtB -> B_6_96_816 [ 0 ] ; _rtXdot -> Integrator_CSTATE = _rtB -> B_6_208_1712 ; ssCallAccelRunBlock ( S , 6 , 91 , SS_CALL_MDL_FORCINGFUNCTION ) ; _rtXdot -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 = ( _rtB -> B_6_11_136 - _rtX -> sscv_wind_turbineSimulink_PS_Converter1outputFiltered_2379984884_0 ) * 1000.0 ; _rtXdot -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 = ( _rtB -> B_6_37_344 - _rtX -> sscv_wind_turbineSimulink_PS_ConverteroutputFiltered_3397113124_0 ) * 1000.0 ; _rtXdot -> TransferFcn_CSTATE_k = 0.0 ; _rtXdot -> TransferFcn_CSTATE_k += _rtP -> P_85 * _rtX -> TransferFcn_CSTATE_k ; _rtXdot -> TransferFcn_CSTATE_k += _rtB -> B_6_174_1440 ; _rtXdot -> TransferFcn2_CSTATE = 0.0 ; _rtXdot -> TransferFcn2_CSTATE += _rtP -> P_87 * _rtX -> TransferFcn2_CSTATE ; _rtXdot -> TransferFcn2_CSTATE += _rtB -> B_6_176_1456 ; ssCallAccelRunBlock ( S , 6 , 106 , SS_CALL_MDL_FORCINGFUNCTION ) ; _rtXdot -> TransferFcn1_CSTATE_c = 0.0 ; _rtXdot -> TransferFcn1_CSTATE_c += _rtP -> P_92 * _rtX -> TransferFcn1_CSTATE_c ; _rtXdot -> TransferFcn1_CSTATE_c += _rtB -> B_6_175_1448 ; if ( _rtXdis -> Integrator_CSTATE_i ) { _rtXdot -> Integrator_CSTATE_i = 0.0 ; } else if ( _rtB -> B_6_210_1728 != 0.0 ) { _rtXdot -> Integrator_CSTATE_i = 0.0 ; } else { _rtXdot -> Integrator_CSTATE_i = _rtB -> B_6_185_1528 ; } _rtXdot -> MeasurementFilter_CSTATE_d = 0.0 ; _rtXdot -> MeasurementFilter_CSTATE_d += _rtP -> P_106 * _rtX -> MeasurementFilter_CSTATE_d ; _rtXdot -> MeasurementFilter_CSTATE_d += _rtB -> B_6_170_1408 [ 0 ] ; }
#define MDL_MASSMATRIX
static void mdlMassMatrix ( SimStruct * S ) { ssCallAccelRunBlock ( S , 6 ,
91 , SS_CALL_MDL_MASSMATRIX ) ; ssCallAccelRunBlock ( S , 6 , 106 ,
SS_CALL_MDL_MASSMATRIX ) ; }
#define MDL_ZERO_CROSSINGS
static void mdlZeroCrossings ( SimStruct * S ) { B_sscv_wind_turbine_T * _rtB
; DW_sscv_wind_turbine_T * _rtDW ; P_sscv_wind_turbine_T * _rtP ;
X_sscv_wind_turbine_T * _rtX ; ZCV_sscv_wind_turbine_T * _rtZCSV ; _rtDW = ( ( DW_sscv_wind_turbine_T * ) ssGetRootDWork ( S ) ) ; _rtZCSV = ( ( ZCV_sscv_wind_turbine_T * ) ssGetSolverZcSignalVector ( S ) ) ; _rtX = ( ( X_sscv_wind_turbine_T * ) ssGetContStates ( S ) ) ; _rtP = ( ( P_sscv_wind_turbine_T * ) ssGetModelRtp ( S ) ) ; _rtB = ( ( B_sscv_wind_turbine_T * ) _ssGetModelBlockIO ( S ) ) ; if ( _rtDW -> TurbineState0an3_MODE ) { _rtZCSV -> Switch_SwitchCond_ZC = _rtB -> B_0_233_1912 - _rtP -> P_3 ; } else { { ( ( ZCV_sscv_wind_turbine_T * ) ssGetSolverZcSignalVector ( S ) ) -> Switch_SwitchCond_ZC = 0.0 ; } } if ( _rtDW -> TurbineState1_MODE ) { _rtZCSV -> Saturation_UprLim_ZC_m = _rtB -> B_1_230_1888 - _rtP -> P_8 ; _rtZCSV -> Saturation_LwrLim_ZC_gi = _rtB -> B_1_230_1888 - _rtP -> P_9 ; } else { { real_T * zcsv = & ( ( ( ZCV_sscv_wind_turbine_T * ) ssGetSolverZcSignalVector ( S ) ) -> Saturation_UprLim_ZC_m ) ; int_T i ; for ( i = 0 ; i < 2 ; i ++ ) { zcsv [ i ] = 0.0 ; } } } if ( _rtDW -> TurbineState2_MODE ) { _rtZCSV -> Saturation_UprLim_ZC_iw = _rtB -> B_2_219_1800 - _rtP -> P_11 ; _rtZCSV -> Saturation_LwrLim_ZC_k = _rtB -> B_2_219_1800 - _rtP -> P_12 ; _rtZCSV -> Saturation1_UprLim_ZC_d = _rtB -> B_2_227_1864 - _rtP -> P_21 ; _rtZCSV -> Saturation1_LwrLim_ZC_m = _rtB -> B_2_227_1864 - _rtP -> P_22 ; } else { { real_T * zcsv = & ( ( ( ZCV_sscv_wind_turbine_T * ) ssGetSolverZcSignalVector ( S ) ) -> Saturation_UprLim_ZC_iw ) ; int_T i ; for ( i = 0 ; i < 4 ; i ++ ) { zcsv [ i ] = 0.0 ; } } } _rtZCSV -> Compare_RelopInput_ZC = _rtB -> B_6_6_96 - _rtB -> B_6_190_1568 ; _rtZCSV -> Compare_RelopInput_ZC_b = _rtB -> B_6_6_96 - _rtB -> B_6_191_1576 ; _rtZCSV -> Step_StepTime_ZC = ssGetT ( S ) - _rtP -> P_56 ; _rtZCSV -> Saturation_UprLim_ZC = _rtB -> B_6_25_248 - _rtP -> P_59 ; _rtZCSV -> Saturation_LwrLim_ZC = _rtB -> B_6_25_248 - _rtP -> P_60 ; _rtZCSV -> Step_StepTime_ZC_e = ssGetT ( S ) - _rtP -> P_61 ; _rtZCSV -> Saturation1_UprLim_ZC = _rtB -> B_6_30_288 - _rtP -> P_64 ; _rtZCSV -> Saturation1_LwrLim_ZC = _rtB -> B_6_30_288 - _rtP -> P_65 ; _rtZCSV -> Step_StepTime_ZC_j = ssGetT ( S ) - _rtP -> P_66 ; _rtZCSV -> Saturation2_UprLim_ZC = _rtB -> B_6_35_328 - _rtP -> P_69 ; _rtZCSV -> Saturation2_LwrLim_ZC = _rtB -> B_6_35_328 - _rtP -> P_70 ; _rtZCSV -> Saturation_UprLim_ZC_n = _rtB -> B_6_45_408 - _rtP -> P_76 ; _rtZCSV -> Saturation_LwrLim_ZC_g = _rtB -> B_6_45_408 - _rtP -> P_77 ; _rtZCSV -> Compare_RelopInput_ZC_a = _rtB -> B_6_47_424 - sscv_wind_turbine_rtC ( S ) -> B_6_262_2096 ; ssCallAccelRunBlock ( S , 6 , 91 , SS_CALL_MDL_ZERO_CROSSINGS ) ; _rtZCSV -> Saturation_UprLim_ZC_i = _rtB -> B_6_114_960 - _rtP -> P_89 ; _rtZCSV -> Saturation_LwrLim_ZC_j = _rtB -> B_6_114_960 - _rtP -> P_90 ; _rtZCSV -> Abs_AbsZc_ZC = _rtB -> B_6_116_976 ; ssCallAccelRunBlock ( S , 6 , 106 , SS_CALL_MDL_ZERO_CROSSINGS ) ; switch ( _rtDW -> Integrator_MODE ) { case 1 : _rtZCSV -> Integrator_xUpperSaturation_ZC = 0.0 ; _rtZCSV -> Integrator_xLowerSaturation_ZC = _rtP -> P_97 - _rtP -> P_98 ; break ; case 2 : _rtZCSV -> Integrator_xUpperSaturation_ZC = _rtP -> P_98 - _rtP -> P_97 ; _rtZCSV -> Integrator_xLowerSaturation_ZC = 0.0 ; break ; default : _rtZCSV -> Integrator_xUpperSaturation_ZC = _rtX -> Integrator_CSTATE_i - _rtP -> P_97 ; _rtZCSV -> Integrator_xLowerSaturation_ZC = _rtX -> Integrator_CSTATE_i - _rtP -> P_98 ; break ; } if ( ( _rtDW -> Integrator_MODE == 3 ) || ( _rtDW -> Integrator_MODE == 4 ) ) { _rtZCSV -> Integrator_InputPortSignal_ZC = _rtB -> B_6_185_1528 ; } else { _rtZCSV -> Integrator_InputPortSignal_ZC = 0.0 ; } _rtZCSV -> Saturation_UprLim_ZC_l = _rtB -> B_6_178_1472 - _rtP -> P_99 ; _rtZCSV -> Saturation_LwrLim_ZC_d = _rtB -> B_6_178_1472 - _rtP -> P_100 ; _rtZCSV -> Abs_AbsZc_ZC_c = _rtB -> B_6_182_1504 ; } static void mdlInitializeSizes ( SimStruct * S ) { ssSetChecksumVal ( S , 0 , 3944887503U ) ; ssSetChecksumVal ( S , 1 , 4000211610U ) ; ssSetChecksumVal ( S , 2 , 2294651164U ) ; ssSetChecksumVal ( S , 3 , 1557005487U ) ; { mxArray * slVerStructMat = ( NULL ) ; mxArray * slStrMat = mxCreateString ( "simulink" ) ; char slVerChar [ 10 ] ; int status = mexCallMATLAB ( 1 , & slVerStructMat , 1 , & slStrMat , "ver" ) ; if ( status == 0 ) { mxArray * slVerMat = mxGetField ( slVerStructMat , 0 , "Version" ) ; if ( slVerMat == ( NULL ) ) { status = 1 ; } else { status = mxGetString ( slVerMat , slVerChar , 10 ) ; } } mxDestroyArray ( slStrMat ) ; mxDestroyArray ( slVerStructMat ) ; if ( ( status == 1 ) || ( strcmp ( slVerChar , "25.2" ) != 0 ) ) { return ; } } ssSetOptions ( S , SS_OPTION_EXCEPTION_FREE_CODE ) ; if ( ssGetSizeofDWork ( S ) != ( SLSize ) sizeof ( DW_sscv_wind_turbine_T ) ) { static char msg [ 256 ] ; snprintf ( msg , 256 , "Unexpected error: Internal DWork sizes do " "not match for accelerator mex file (%ld vs %lu)." , ( signed long ) ssGetSizeofDWork ( S ) , ( unsigned long ) sizeof ( DW_sscv_wind_turbine_T ) ) ; ssSetErrorStatus ( S , msg ) ; } if ( ssGetSizeofGlobalBlockIO ( S ) != ( SLSize ) sizeof ( B_sscv_wind_turbine_T ) ) { static char msg [ 256 ] ; snprintf ( msg , 256 , "Unexpected error: Internal BlockIO sizes do " "not match for accelerator mex file (%ld vs %lu)." , ( signed long ) ssGetSizeofGlobalBlockIO ( S ) , ( unsigned long ) sizeof ( B_sscv_wind_turbine_T ) ) ; ssSetErrorStatus ( S , msg ) ; } { int ssSizeofParams ; ssGetSizeofParams ( S , & ssSizeofParams ) ; if ( ssSizeofParams != sizeof ( P_sscv_wind_turbine_T ) ) { static char msg [ 256 ] ; snprintf ( msg , 256 , "Unexpected error: Internal Parameters sizes do " "not match for accelerator mex file (%d vs %lu)." , ssSizeofParams , ( unsigned long ) sizeof ( P_sscv_wind_turbine_T ) ) ; ssSetErrorStatus ( S , msg ) ; } } _ssSetModelRtp ( S , ( real_T * ) & sscv_wind_turbine_rtDefaultP ) ; _ssSetConstBlockIO ( S , & sscv_wind_turbine_rtInvariant ) ; if ( ssGetSizeofDWork ( S ) == ( SLSize ) sizeof ( DW_sscv_wind_turbine_T ) ) { { ( ( DW_sscv_wind_turbine_T * ) ssGetRootDWork ( S ) ) -> STATE_1_MASS_MATRIX_PR = 10 ; ( ( DW_sscv_wind_turbine_T * ) ssGetRootDWork ( S ) ) -> STATE_1_MASS_MATRIX_PR_h = 32 ; } } } static void mdlInitializeSampleTimes ( SimStruct * S ) { { SimStruct * childS ; SysOutputFcn * callSysFcns ; childS = ssGetSFunction ( S , 0 ) ; callSysFcns = ssGetCallSystemOutputFcnList ( childS ) ; callSysFcns [ 3 + 0 ] = ( SysOutputFcn ) ( NULL ) ; } slAccRegPrmChangeFcn ( S , mdlOutputsTID2 ) ; } static void mdlTerminate ( SimStruct * S ) { }
#include "simulink.c"
